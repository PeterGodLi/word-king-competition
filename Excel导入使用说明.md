# 📥 Excel单词库导入功能使用说明

## 功能概述

单词王比赛应用现在支持从Excel文件导入自定义单词库，让您可以轻松添加和管理自己的单词集合。

## 支持的文件格式

- ✅ `.xlsx` - Microsoft Excel 2007及更高版本
- ✅ `.xls` - Microsoft Excel 97-2003
- ✅ `.csv` - 逗号分隔值文件

## Excel文件格式要求

### 必需列（至少包含以下两列）

1. **单词/Word** - 英文单词（必填）
2. **中文/Translation** - 中文释义（必填）

### 可选列

3. **话题/Category** - 单词分类（可选，默认为"未分类"）
4. **音标/Phonetic** - 音标（可选）
5. **例句/Example** - 例句（可选）

### 列名识别

程序支持智能识别列名，可以使用以下任意名称：

- **单词列**: 单词、word、Word、WORD、英文、english、English
- **中文列**: 中文、中文释义、释义、translation、Translation、chinese、Chinese、意思
- **分类列**: 话题、分类、类别、category、Category、topic、Topic
- **音标列**: 音标、phonetic、Phonetic、发音
- **例句列**: 例句、example、Example、示例、sentence

## Excel文件示例

| 话题 | 单词 | 音标 | 中文 | 例句 |
|------|------|------|------|------|
| 交通工具 | car | /kɑː/ | 汽车 | I go to school by car. 我坐汽车去上学。 |
| 交通工具 | bus | /bʌs/ | 公共汽车 | The bus is coming. 公共汽车来了。 |
| 天气 | sunny | /ˈsʌni/ | 晴朗的 | It's sunny today. 今天天气晴朗。 |
| 天气 | rainy | /ˈreɪni/ | 下雨的 | It's rainy outside. 外面在下雨。 |

## 使用步骤

### 1. 准备Excel文件

- 按照上述格式创建Excel文件
- 确保至少包含"单词"和"中文"两列
- 第一行应为列名标题

### 2. 导入文件

1. 点击主菜单的 **"📥 导入单词库"** 按钮
2. 在弹出的对话框中：
   - 点击上传区域选择文件，或
   - 直接拖拽文件到上传区域
3. 等待文件解析完成

### 3. 预览数据

- 系统会自动解析文件并显示预览
- 查看统计信息：分类数量、单词总数
- 检查是否有警告或错误信息
- 预览每个分类的部分单词

### 4. 确认导入

- 检查预览数据无误后，点击 **"导入单词库"** 按钮
- 等待导入完成提示
- 导入的单词会自动整合到现有单词库中

### 5. 使用导入的单词

- 返回主菜单选择任意学习模式
- 在话题选择界面可以看到导入的新分类
- 导入的单词可用于所有学习模式：
  - 📚 背单词模式
  - ✍️ 检查模式
  - ⚡ 挑战模式

## 重要提示

### ✅ 推荐做法

- 使用清晰的分类名称，便于组织和查找
- 填写音标帮助正确发音
- 添加例句加深理解
- 定期备份您的Excel文件

### ⚠️ 注意事项

- 单词和中文释义为必填项，缺少会被跳过
- 重复的单词会被自动去重（基于单词拼写）
- 音标会自动添加斜杠格式 /音标/
- 导入的数据会保存在浏览器本地存储中
- 清除浏览器数据会删除导入的单词

### ❌ 常见错误

1. **文件格式不支持** - 请使用 .xlsx、.xls 或 .csv 格式
2. **缺少必填列** - 确保包含"单词"和"中文"列
3. **文件为空** - 检查Excel文件是否包含数据行
4. **编码问题** - CSV文件请使用UTF-8编码

## 数据管理

### 本地存储

- 导入的单词库自动保存在浏览器本地存储
- 下次打开应用时会自动加载
- 不需要重复导入相同的文件

### 合并策略

- 新导入的分类会自动添加到单词库
- 已存在的分类会合并单词（自动去重）
- 不会覆盖原有的内置单词库

### 数据导出

- 目前不支持导出功能
- 建议保留原始Excel文件作为备份

## 示例文件

项目中包含 `示例单词库.csv` 文件，包含以下内容：

- **交通工具**：car, bus, bike, train, plane
- **天气**：sunny, rainy, cloudy, windy, snowy
- **运动**：run, jump, swim, play, basketball
- **职业**：teacher, doctor, nurse, farmer, driver

您可以直接导入此文件测试导入功能。

## 技术特性

- ✅ 前端Excel解析（使用SheetJS/xlsx库）
- ✅ 智能列名识别
- ✅ 实时进度反馈
- ✅ 详细错误提示
- ✅ 数据预览
- ✅ 自动去重
- ✅ 拖拽上传支持
- ✅ 本地持久化存储
- ✅ 格式自动规范化

## 常见问题

**Q: 导入后在哪里可以看到新单词？**

A: 返回主菜单选择任意学习模式，在话题选择界面就能看到导入的分类。

**Q: 可以导入多少单词？**

A: 理论上没有限制，但建议单次导入不超过5000个单词以保证性能。

**Q: 如何删除导入的单词？**

A: 目前需要清除浏览器缓存来删除导入的数据，未来版本会添加管理功能。

**Q: 支持批量导入吗？**

A: 目前一次只能导入一个文件，但可以多次导入不同文件，数据会自动合并。

**Q: 导入的单词能否跨设备同步？**

A: 目前数据存储在浏览器本地，不支持跨设备同步。建议在不同设备上分别导入。

## 更新日志

### v1.0 (2025-11-26)

- ✅ 首次发布Excel导入功能
- ✅ 支持 .xlsx、.xls、.csv 格式
- ✅ 智能列名识别
- ✅ 实时进度反馈
- ✅ 数据预览和错误处理
- ✅ 本地存储持久化
- ✅ 拖拽上传支持

---

如有问题或建议，欢迎反馈！🎉
