#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ç”Ÿæˆç¤ºä¾‹Excelæ–‡ä»¶ç”¨äºæµ‹è¯•å¯¼å…¥åŠŸèƒ½
"""

import pandas as pd
import os

def create_sample_excel():
    """åˆ›å»ºç¤ºä¾‹Excelæ–‡ä»¶"""
    
    # ç¤ºä¾‹å•è¯æ•°æ®
    words_data = [
        # äº¤é€šå·¥å…·
        {'è¯é¢˜': 'äº¤é€šå·¥å…·', 'å•è¯': 'car', 'éŸ³æ ‡': 'kÉ‘Ë', 'ä¸­æ–‡': 'æ±½è½¦', 'ä¾‹å¥': 'I go to school by car. æˆ‘åæ±½è½¦å»ä¸Šå­¦ã€‚'},
        {'è¯é¢˜': 'äº¤é€šå·¥å…·', 'å•è¯': 'bus', 'éŸ³æ ‡': 'bÊŒs', 'ä¸­æ–‡': 'å…¬å…±æ±½è½¦', 'ä¾‹å¥': 'The bus is coming. å…¬å…±æ±½è½¦æ¥äº†ã€‚'},
        {'è¯é¢˜': 'äº¤é€šå·¥å…·', 'å•è¯': 'bike', 'éŸ³æ ‡': 'baÉªk', 'ä¸­æ–‡': 'è‡ªè¡Œè½¦', 'ä¾‹å¥': 'I ride a bike. æˆ‘éª‘è‡ªè¡Œè½¦ã€‚'},
        {'è¯é¢˜': 'äº¤é€šå·¥å…·', 'å•è¯': 'train', 'éŸ³æ ‡': 'treÉªn', 'ä¸­æ–‡': 'ç«è½¦', 'ä¾‹å¥': 'The train is fast. ç«è½¦å¾ˆå¿«ã€‚'},
        {'è¯é¢˜': 'äº¤é€šå·¥å…·', 'å•è¯': 'plane', 'éŸ³æ ‡': 'pleÉªn', 'ä¸­æ–‡': 'é£æœº', 'ä¾‹å¥': 'The plane flies high. é£æœºé£å¾—å¾ˆé«˜ã€‚'},
        {'è¯é¢˜': 'äº¤é€šå·¥å…·', 'å•è¯': 'ship', 'éŸ³æ ‡': 'ÊƒÉªp', 'ä¸­æ–‡': 'è½®èˆ¹', 'ä¾‹å¥': 'The ship is on the sea. è½®èˆ¹åœ¨æµ·ä¸Šã€‚'},
        {'è¯é¢˜': 'äº¤é€šå·¥å…·', 'å•è¯': 'taxi', 'éŸ³æ ‡': 'ËˆtÃ¦ksi', 'ä¸­æ–‡': 'å‡ºç§Ÿè½¦', 'ä¾‹å¥': 'Take a taxi to the airport. ä¹˜å‡ºç§Ÿè½¦å»æœºåœºã€‚'},
        
        # å¤©æ°”
        {'è¯é¢˜': 'å¤©æ°”', 'å•è¯': 'sunny', 'éŸ³æ ‡': 'ËˆsÊŒni', 'ä¸­æ–‡': 'æ™´æœ—çš„', 'ä¾‹å¥': "It's sunny today. ä»Šå¤©å¤©æ°”æ™´æœ—ã€‚"},
        {'è¯é¢˜': 'å¤©æ°”', 'å•è¯': 'rainy', 'éŸ³æ ‡': 'ËˆreÉªni', 'ä¸­æ–‡': 'ä¸‹é›¨çš„', 'ä¾‹å¥': "It's rainy outside. å¤–é¢åœ¨ä¸‹é›¨ã€‚"},
        {'è¯é¢˜': 'å¤©æ°”', 'å•è¯': 'cloudy', 'éŸ³æ ‡': 'ËˆklaÊŠdi', 'ä¸­æ–‡': 'å¤šäº‘çš„', 'ä¾‹å¥': "It's cloudy now. ç°åœ¨å¤šäº‘ã€‚"},
        {'è¯é¢˜': 'å¤©æ°”', 'å•è¯': 'windy', 'éŸ³æ ‡': 'ËˆwÉªndi', 'ä¸­æ–‡': 'æœ‰é£çš„', 'ä¾‹å¥': "It's very windy. é£å¾ˆå¤§ã€‚"},
        {'è¯é¢˜': 'å¤©æ°”', 'å•è¯': 'snowy', 'éŸ³æ ‡': 'ËˆsnÉ™ÊŠi', 'ä¸­æ–‡': 'ä¸‹é›ªçš„', 'ä¾‹å¥': "It's snowy in winter. å†¬å¤©ä¼šä¸‹é›ªã€‚"},
        {'è¯é¢˜': 'å¤©æ°”', 'å•è¯': 'hot', 'éŸ³æ ‡': 'hÉ’t', 'ä¸­æ–‡': 'çƒ­çš„', 'ä¾‹å¥': "It's hot in summer. å¤å¤©å¾ˆçƒ­ã€‚"},
        {'è¯é¢˜': 'å¤©æ°”', 'å•è¯': 'cold', 'éŸ³æ ‡': 'kÉ™ÊŠld', 'ä¸­æ–‡': 'å†·çš„', 'ä¾‹å¥': "It's cold in winter. å†¬å¤©å¾ˆå†·ã€‚"},
        
        # è¿åŠ¨
        {'è¯é¢˜': 'è¿åŠ¨', 'å•è¯': 'run', 'éŸ³æ ‡': 'rÊŒn', 'ä¸­æ–‡': 'è·‘æ­¥', 'ä¾‹å¥': 'I like to run. æˆ‘å–œæ¬¢è·‘æ­¥ã€‚'},
        {'è¯é¢˜': 'è¿åŠ¨', 'å•è¯': 'jump', 'éŸ³æ ‡': 'dÊ’ÊŒmp', 'ä¸­æ–‡': 'è·³', 'ä¾‹å¥': 'I can jump high. æˆ‘å¯ä»¥è·³å¾—å¾ˆé«˜ã€‚'},
        {'è¯é¢˜': 'è¿åŠ¨', 'å•è¯': 'swim', 'éŸ³æ ‡': 'swÉªm', 'ä¸­æ–‡': 'æ¸¸æ³³', 'ä¾‹å¥': 'I swim in summer. æˆ‘å¤å¤©æ¸¸æ³³ã€‚'},
        {'è¯é¢˜': 'è¿åŠ¨', 'å•è¯': 'play', 'éŸ³æ ‡': 'pleÉª', 'ä¸­æ–‡': 'ç©/è¿åŠ¨', 'ä¾‹å¥': "Let's play football. æˆ‘ä»¬è¸¢è¶³çƒå§ã€‚"},
        {'è¯é¢˜': 'è¿åŠ¨', 'å•è¯': 'basketball', 'éŸ³æ ‡': 'ËˆbÉ‘ËskÉªtbÉ”Ël', 'ä¸­æ–‡': 'ç¯®çƒ', 'ä¾‹å¥': 'I play basketball. æˆ‘æ‰“ç¯®çƒã€‚'},
        {'è¯é¢˜': 'è¿åŠ¨', 'å•è¯': 'football', 'éŸ³æ ‡': 'ËˆfÊŠtbÉ”Ël', 'ä¸­æ–‡': 'è¶³çƒ', 'ä¾‹å¥': 'Football is popular. è¶³çƒå¾ˆå—æ¬¢è¿ã€‚'},
        {'è¯é¢˜': 'è¿åŠ¨', 'å•è¯': 'dance', 'éŸ³æ ‡': 'dÉ‘Ëns', 'ä¸­æ–‡': 'è·³èˆ', 'ä¾‹å¥': 'I like to dance. æˆ‘å–œæ¬¢è·³èˆã€‚'},
        
        # èŒä¸š
        {'è¯é¢˜': 'èŒä¸š', 'å•è¯': 'teacher', 'éŸ³æ ‡': 'ËˆtiËtÊƒÉ™', 'ä¸­æ–‡': 'æ•™å¸ˆ', 'ä¾‹å¥': 'My mother is a teacher. æˆ‘å¦ˆå¦ˆæ˜¯è€å¸ˆã€‚'},
        {'è¯é¢˜': 'èŒä¸š', 'å•è¯': 'doctor', 'éŸ³æ ‡': 'ËˆdÉ’ktÉ™', 'ä¸­æ–‡': 'åŒ»ç”Ÿ', 'ä¾‹å¥': 'The doctor is kind. è¿™ä½åŒ»ç”Ÿå¾ˆå’Œè”¼ã€‚'},
        {'è¯é¢˜': 'èŒä¸š', 'å•è¯': 'nurse', 'éŸ³æ ‡': 'nÉœËs', 'ä¸­æ–‡': 'æŠ¤å£«', 'ä¾‹å¥': 'She is a nurse. å¥¹æ˜¯æŠ¤å£«ã€‚'},
        {'è¯é¢˜': 'èŒä¸š', 'å•è¯': 'farmer', 'éŸ³æ ‡': 'ËˆfÉ‘ËmÉ™', 'ä¸­æ–‡': 'å†œæ°‘', 'ä¾‹å¥': 'The farmer works hard. å†œæ°‘å·¥ä½œå¾ˆè¾›è‹¦ã€‚'},
        {'è¯é¢˜': 'èŒä¸š', 'å•è¯': 'driver', 'éŸ³æ ‡': 'ËˆdraÉªvÉ™', 'ä¸­æ–‡': 'å¸æœº', 'ä¾‹å¥': 'My father is a driver. æˆ‘çˆ¸çˆ¸æ˜¯å¸æœºã€‚'},
        {'è¯é¢˜': 'èŒä¸š', 'å•è¯': 'cook', 'éŸ³æ ‡': 'kÊŠk', 'ä¸­æ–‡': 'å¨å¸ˆ', 'ä¾‹å¥': 'The cook makes delicious food. å¨å¸ˆåšç¾å‘³çš„é£Ÿç‰©ã€‚'},
        {'è¯é¢˜': 'èŒä¸š', 'å•è¯': 'worker', 'éŸ³æ ‡': 'ËˆwÉœËkÉ™', 'ä¸­æ–‡': 'å·¥äºº', 'ä¾‹å¥': 'He is a worker. ä»–æ˜¯å·¥äººã€‚'},
        
        # åœ°ç‚¹
        {'è¯é¢˜': 'åœ°ç‚¹', 'å•è¯': 'school', 'éŸ³æ ‡': 'skuËl', 'ä¸­æ–‡': 'å­¦æ ¡', 'ä¾‹å¥': 'I go to school every day. æˆ‘æ¯å¤©ä¸Šå­¦ã€‚'},
        {'è¯é¢˜': 'åœ°ç‚¹', 'å•è¯': 'home', 'éŸ³æ ‡': 'hÉ™ÊŠm', 'ä¸­æ–‡': 'å®¶', 'ä¾‹å¥': 'I am at home. æˆ‘åœ¨å®¶ã€‚'},
        {'è¯é¢˜': 'åœ°ç‚¹', 'å•è¯': 'park', 'éŸ³æ ‡': 'pÉ‘Ëk', 'ä¸­æ–‡': 'å…¬å›­', 'ä¾‹å¥': 'The park is beautiful. å…¬å›­å¾ˆç¾ã€‚'},
        {'è¯é¢˜': 'åœ°ç‚¹', 'å•è¯': 'zoo', 'éŸ³æ ‡': 'zuË', 'ä¸­æ–‡': 'åŠ¨ç‰©å›­', 'ä¾‹å¥': 'I like the zoo. æˆ‘å–œæ¬¢åŠ¨ç‰©å›­ã€‚'},
        {'è¯é¢˜': 'åœ°ç‚¹', 'å•è¯': 'hospital', 'éŸ³æ ‡': 'ËˆhÉ’spÉªtl', 'ä¸­æ–‡': 'åŒ»é™¢', 'ä¾‹å¥': 'The hospital is big. åŒ»é™¢å¾ˆå¤§ã€‚'},
        {'è¯é¢˜': 'åœ°ç‚¹', 'å•è¯': 'library', 'éŸ³æ ‡': 'ËˆlaÉªbrÉ™ri', 'ä¸­æ–‡': 'å›¾ä¹¦é¦†', 'ä¾‹å¥': 'I read books in the library. æˆ‘åœ¨å›¾ä¹¦é¦†è¯»ä¹¦ã€‚'},
        {'è¯é¢˜': 'åœ°ç‚¹', 'å•è¯': 'supermarket', 'éŸ³æ ‡': 'ËˆsuËpÉ™mÉ‘ËkÉªt', 'ä¸­æ–‡': 'è¶…å¸‚', 'ä¾‹å¥': 'I buy food at the supermarket. æˆ‘åœ¨è¶…å¸‚ä¹°é£Ÿç‰©ã€‚'},
    ]
    
    # åˆ›å»ºDataFrame
    df = pd.DataFrame(words_data)
    
    # ä¿å­˜ä¸ºExcelæ–‡ä»¶
    excel_file = 'å®Œæ•´ç¤ºä¾‹å•è¯åº“.xlsx'
    df.to_excel(excel_file, index=False, engine='openpyxl')
    print(f'âœ… å·²åˆ›å»º Excel æ–‡ä»¶: {excel_file}')
    print(f'   - å…± {len(df)} ä¸ªå•è¯')
    print(f'   - {df["è¯é¢˜"].nunique()} ä¸ªè¯é¢˜åˆ†ç±»')
    
    # ä¿å­˜ä¸ºCSVæ–‡ä»¶ï¼ˆç”¨äºä¸åŒæ ¼å¼æµ‹è¯•ï¼‰
    csv_file = 'å®Œæ•´ç¤ºä¾‹å•è¯åº“.csv'
    df.to_csv(csv_file, index=False, encoding='utf-8')
    print(f'âœ… å·²åˆ›å»º CSV æ–‡ä»¶: {csv_file}')
    
    # åˆ›å»ºè‹±æ–‡åˆ—åç‰ˆæœ¬
    df_en = df.copy()
    df_en.columns = ['Category', 'Word', 'Phonetic', 'Translation', 'Example']
    excel_file_en = 'ç¤ºä¾‹å•è¯åº“_è‹±æ–‡åˆ—å.xlsx'
    df_en.to_excel(excel_file_en, index=False, engine='openpyxl')
    print(f'âœ… å·²åˆ›å»º è‹±æ–‡åˆ—åExcel: {excel_file_en}')
    
    # åˆ›å»ºæœ€ç®€ç‰ˆæœ¬ï¼ˆåªæœ‰å¿…å¡«åˆ—ï¼‰
    df_simple = df[['å•è¯', 'ä¸­æ–‡']].copy()
    excel_file_simple = 'ç¤ºä¾‹å•è¯åº“_æœ€ç®€ç‰ˆ.xlsx'
    df_simple.to_excel(excel_file_simple, index=False, engine='openpyxl')
    print(f'âœ… å·²åˆ›å»º æœ€ç®€ç‰ˆExcel: {excel_file_simple}')
    
    # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
    print('\nğŸ“Š è¯é¢˜åˆ†ç±»ç»Ÿè®¡:')
    category_counts = df['è¯é¢˜'].value_counts()
    for category, count in category_counts.items():
        print(f'   - {category}: {count} ä¸ªå•è¯')
    
    print('\nğŸ’¡ ä½¿ç”¨è¯´æ˜:')
    print('   1. æ‰“å¼€å•è¯ç‹æ¯”èµ›åº”ç”¨')
    print('   2. ç‚¹å‡»"ğŸ“¥ å¯¼å…¥å•è¯åº“"')
    print('   3. ä¸Šä¼ ä»»ä¸€ç”Ÿæˆçš„Excel/CSVæ–‡ä»¶')
    print('   4. é¢„è§ˆå¹¶ç¡®è®¤å¯¼å…¥')
    print('   5. åœ¨å­¦ä¹ æ¨¡å¼ä¸­ä½¿ç”¨å¯¼å…¥çš„å•è¯')

def create_test_files():
    """åˆ›å»ºå„ç§æµ‹è¯•æ–‡ä»¶"""
    
    print('\nğŸ§ª åˆ›å»ºæµ‹è¯•æ–‡ä»¶...\n')
    
    # æµ‹è¯•1: æœ‰é”™è¯¯çš„æ–‡ä»¶ï¼ˆç¼ºå°‘å¿…å¡«å­—æ®µï¼‰
    error_data = [
        {'è¯é¢˜': 'æµ‹è¯•', 'å•è¯': 'test', 'ä¸­æ–‡': 'æµ‹è¯•'},
        {'è¯é¢˜': 'é”™è¯¯', 'å•è¯': '', 'ä¸­æ–‡': 'ç©ºå•è¯'},  # é”™è¯¯ï¼šç©ºå•è¯
        {'è¯é¢˜': 'é”™è¯¯', 'å•è¯': 'error', 'ä¸­æ–‡': ''},   # é”™è¯¯ï¼šç©ºä¸­æ–‡
    ]
    df_error = pd.DataFrame(error_data)
    df_error.to_excel('æµ‹è¯•_å«é”™è¯¯æ•°æ®.xlsx', index=False, engine='openpyxl')
    print('âœ… å·²åˆ›å»º æµ‹è¯•_å«é”™è¯¯æ•°æ®.xlsx (ç”¨äºæµ‹è¯•é”™è¯¯å¤„ç†)')
    
    # æµ‹è¯•2: å¤§é‡æ•°æ®
    large_data = []
    for i in range(100):
        large_data.append({
            'è¯é¢˜': f'åˆ†ç±»{i // 10 + 1}',
            'å•è¯': f'word{i+1}',
            'éŸ³æ ‡': f'wÉœËd{i+1}',
            'ä¸­æ–‡': f'å•è¯{i+1}',
            'ä¾‹å¥': f'This is word {i+1}. è¿™æ˜¯å•è¯{i+1}ã€‚'
        })
    df_large = pd.DataFrame(large_data)
    df_large.to_excel('æµ‹è¯•_å¤§é‡æ•°æ®.xlsx', index=False, engine='openpyxl')
    print(f'âœ… å·²åˆ›å»º æµ‹è¯•_å¤§é‡æ•°æ®.xlsx ({len(large_data)} ä¸ªå•è¯)')
    
    print('\nâœ¨ æ‰€æœ‰æµ‹è¯•æ–‡ä»¶åˆ›å»ºå®Œæˆï¼')

if __name__ == '__main__':
    print('=' * 60)
    print('ç¤ºä¾‹Excelæ–‡ä»¶ç”Ÿæˆå·¥å…·')
    print('=' * 60)
    
    try:
        # åˆ›å»ºç¤ºä¾‹æ–‡ä»¶
        create_sample_excel()
        
        # åˆ›å»ºæµ‹è¯•æ–‡ä»¶
        create_test_files()
        
        print('\n' + '=' * 60)
        print('âœ… å…¨éƒ¨å®Œæˆï¼')
        print('=' * 60)
        
    except Exception as e:
        print(f'\nâŒ é”™è¯¯: {str(e)}')
        import traceback
        traceback.print_exc()
